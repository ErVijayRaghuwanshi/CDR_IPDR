[
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9876543210","target_id":"TGT001","target_type":"MOBILE_NUMBER","rule_id":"R001","rule_type":"Rule","rule":"High-Frequency Communication Between Two Parties","data_source":"CDR","rule_desc":"Detects unusually frequent calls or messages between two numbers within a short time window.","required_fields":["MOBILENUMBER","B_MOBILENUMBER","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, B_MOBILENUMBER, COUNT(*) AS TOTAL_CALLS FROM cdr WHERE TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER, B_MOBILENUMBER HAVING TOTAL_CALLS > $FREQUENCY_THRESHOLD","custom_params":{"FREQUENCY_THRESHOLD":40}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9876543210","target_id":"TGT001","target_type":"MOBILE_NUMBER","rule_id":"R002","rule_type":"Rule","rule":"Unusual Call Duration","data_source":"CDR","rule_desc":"Detects abnormally long or short calls.","required_fields":["MOBILENUMBER","B_MOBILENUMBER","DURATION"],"sql_template":"SELECT MOBILENUMBER, B_MOBILENUMBER, DURATION FROM cdr WHERE DURATION < $MIN_DURATION_SEC OR DURATION > $MAX_DURATION_SEC","custom_params":{"MAX_DURATION_SEC":1500}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9876543210","target_id":"TGT001","target_type":"MOBILE_NUMBER","rule_id":"R003","rule_type":"Rule","rule":"Communication With Known Blacklisted Numbers","data_source":"CDR","rule_desc":"Flags calls or messages to/from numbers on a watchlist.","required_fields":["MOBILENUMBER","B_MOBILENUMBER"],"sql_template":"SELECT c.MOBILENUMBER, c.B_MOBILENUMBER, w.WATCHLIST_ID AS MATCHED_WATCHLIST_ID FROM cdr c JOIN $WATCHLIST_TABLE w ON c.MOBILENUMBER = w.NUMBER OR c.B_MOBILENUMBER = w.NUMBER","custom_params":{}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9876543210","target_id":"TGT001","target_type":"MOBILE_NUMBER","rule_id":"R004","rule_type":"Rule","rule":"Frequent Cell Tower Location Changes","data_source":"CDR","rule_desc":"Detects rapid movement across large distances.","required_fields":["MOBILENUMBER","BTS","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, COUNT(DISTINCT BTS) AS TOTAL_BTS_CHANGES FROM cdr WHERE TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER HAVING TOTAL_BTS_CHANGES > $LOCATION_CHANGE_THRESHOLD","custom_params":{"LOCATION_CHANGE_THRESHOLD":4}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9876543210","target_id":"TGT001","target_type":"MOBILE_NUMBER","rule_id":"R005","rule_type":"Rule","rule":"SIM Swap Detection","data_source":"CDR","rule_desc":"Detects multiple IMEIs for same mobile number in a short time window, indicating a potential SIM swap.","required_fields":["MOBILENUMBER","IMEI","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, COUNT(DISTINCT IMEI) AS CHANGE_COUNT FROM cdr WHERE TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER HAVING CHANGE_COUNT > $IMEI_CHANGE_THRESHOLD","custom_params":{}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9876543210","target_id":"TGT001","target_type":"MOBILE_NUMBER","rule_id":"R006","rule_type":"Rule","rule":"High Volume of International Calls","data_source":"CDR","rule_desc":"Flags unusual spikes in calls to foreign destinations, often used for organized crime.","required_fields":["MOBILENUMBER","DSTCOUNTRY","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, DSTCOUNTRY, COUNT(*) AS TOTAL_FOREIGN_CALLS FROM cdr WHERE DSTCOUNTRY <> 'LOCAL' AND TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER, DSTCOUNTRY HAVING TOTAL_FOREIGN_CALLS > $FOREIGN_CALL_THRESHOLD","custom_params":{"FOREIGN_CALL_THRESHOLD":8}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9876543210","target_id":"TGT001","target_type":"MOBILE_NUMBER","rule_id":"R009","rule_type":"Rule","rule":"Suspicious VoIP Traffic","data_source":"IPDR","rule_desc":"Detects encrypted or obfuscated VoIP calls outside of normal business hours, which may indicate covert communication.","required_fields":["MOBILENUMBER","APPLICATION","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, APPLICATION FROM ipdr WHERE APPLICATION = 'VoIP' AND (HOUR(TRANSACTIONSTARTTIME) < $ALLOWED_HOURS_START OR HOUR(TRANSACTIONSTARTTIME) > $ALLOWED_HOURS_END)","custom_params":{"ALLOWED_HOURS_END":20,"ALLOWED_HOURS_START":6}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9876543210","target_id":"TGT001","target_type":"MOBILE_NUMBER","rule_id":"R010","rule_type":"Rule","rule":"Repeated Contact With Foreign IP Addresses","data_source":"IPDR","rule_desc":"Flags repeated communications with the same foreign server IP, which could signal a command-and-control connection.","required_fields":["MOBILENUMBER","SERVERIP","DSTCOUNTRY"],"sql_template":"SELECT MOBILENUMBER, SERVERIP, DSTCOUNTRY FROM ipdr WHERE DSTCOUNTRY <> 'LOCAL' AND TRANSACTIONSTARTTIME >= DATEADD(DAY, -$TIME_WINDOW_DAYS, CURRENT_DATE) GROUP BY MOBILENUMBER, SERVERIP, DSTCOUNTRY HAVING COUNT(*) > $REPEAT_CONTACT_THRESHOLD","custom_params":{}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"359123450123457","target_id":"TGT002","target_type":"IMEI","rule_id":"R001","rule_type":"Rule","rule":"High-Frequency Communication Between Two Parties","data_source":"CDR","rule_desc":"Detects unusually frequent calls or messages between two numbers within a short time window.","required_fields":["MOBILENUMBER","B_MOBILENUMBER","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, B_MOBILENUMBER, COUNT(*) AS TOTAL_CALLS FROM cdr WHERE TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER, B_MOBILENUMBER HAVING TOTAL_CALLS > $FREQUENCY_THRESHOLD","custom_params":{"FREQUENCY_THRESHOLD":40}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"359123450123457","target_id":"TGT002","target_type":"IMEI","rule_id":"R002","rule_type":"Rule","rule":"Unusual Call Duration","data_source":"CDR","rule_desc":"Detects abnormally long or short calls.","required_fields":["MOBILENUMBER","B_MOBILENUMBER","DURATION"],"sql_template":"SELECT MOBILENUMBER, B_MOBILENUMBER, DURATION FROM cdr WHERE DURATION < $MIN_DURATION_SEC OR DURATION > $MAX_DURATION_SEC","custom_params":{"MAX_DURATION_SEC":1500}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"359123450123457","target_id":"TGT002","target_type":"IMEI","rule_id":"R003","rule_type":"Rule","rule":"Communication With Known Blacklisted Numbers","data_source":"CDR","rule_desc":"Flags calls or messages to/from numbers on a watchlist.","required_fields":["MOBILENUMBER","B_MOBILENUMBER"],"sql_template":"SELECT c.MOBILENUMBER, c.B_MOBILENUMBER, w.WATCHLIST_ID AS MATCHED_WATCHLIST_ID FROM cdr c JOIN $WATCHLIST_TABLE w ON c.MOBILENUMBER = w.NUMBER OR c.B_MOBILENUMBER = w.NUMBER","custom_params":{}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"359123450123457","target_id":"TGT002","target_type":"IMEI","rule_id":"R004","rule_type":"Rule","rule":"Frequent Cell Tower Location Changes","data_source":"CDR","rule_desc":"Detects rapid movement across large distances.","required_fields":["MOBILENUMBER","BTS","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, COUNT(DISTINCT BTS) AS TOTAL_BTS_CHANGES FROM cdr WHERE TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER HAVING TOTAL_BTS_CHANGES > $LOCATION_CHANGE_THRESHOLD","custom_params":{"LOCATION_CHANGE_THRESHOLD":4}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"359123450123457","target_id":"TGT002","target_type":"IMEI","rule_id":"R005","rule_type":"Rule","rule":"SIM Swap Detection","data_source":"CDR","rule_desc":"Detects multiple IMEIs for same mobile number in a short time window, indicating a potential SIM swap.","required_fields":["MOBILENUMBER","IMEI","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, COUNT(DISTINCT IMEI) AS CHANGE_COUNT FROM cdr WHERE TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER HAVING CHANGE_COUNT > $IMEI_CHANGE_THRESHOLD","custom_params":{}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"359123450123457","target_id":"TGT002","target_type":"IMEI","rule_id":"R006","rule_type":"Rule","rule":"High Volume of International Calls","data_source":"CDR","rule_desc":"Flags unusual spikes in calls to foreign destinations, often used for organized crime.","required_fields":["MOBILENUMBER","DSTCOUNTRY","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, DSTCOUNTRY, COUNT(*) AS TOTAL_FOREIGN_CALLS FROM cdr WHERE DSTCOUNTRY <> 'LOCAL' AND TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER, DSTCOUNTRY HAVING TOTAL_FOREIGN_CALLS > $FOREIGN_CALL_THRESHOLD","custom_params":{"FOREIGN_CALL_THRESHOLD":8}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"359123450123457","target_id":"TGT002","target_type":"IMEI","rule_id":"R009","rule_type":"Rule","rule":"Suspicious VoIP Traffic","data_source":"IPDR","rule_desc":"Detects encrypted or obfuscated VoIP calls outside of normal business hours, which may indicate covert communication.","required_fields":["MOBILENUMBER","APPLICATION","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, APPLICATION FROM ipdr WHERE APPLICATION = 'VoIP' AND (HOUR(TRANSACTIONSTARTTIME) < $ALLOWED_HOURS_START OR HOUR(TRANSACTIONSTARTTIME) > $ALLOWED_HOURS_END)","custom_params":{"ALLOWED_HOURS_END":20,"ALLOWED_HOURS_START":6}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"359123450123457","target_id":"TGT002","target_type":"IMEI","rule_id":"R010","rule_type":"Rule","rule":"Repeated Contact With Foreign IP Addresses","data_source":"IPDR","rule_desc":"Flags repeated communications with the same foreign server IP, which could signal a command-and-control connection.","required_fields":["MOBILENUMBER","SERVERIP","DSTCOUNTRY"],"sql_template":"SELECT MOBILENUMBER, SERVERIP, DSTCOUNTRY FROM ipdr WHERE DSTCOUNTRY <> 'LOCAL' AND TRANSACTIONSTARTTIME >= DATEADD(DAY, -$TIME_WINDOW_DAYS, CURRENT_DATE) GROUP BY MOBILENUMBER, SERVERIP, DSTCOUNTRY HAVING COUNT(*) > $REPEAT_CONTACT_THRESHOLD","custom_params":{}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"8765432109","target_id":"TGT005","target_type":"MOBILE_NUMBER","rule_id":"R001","rule_type":"Rule","rule":"High-Frequency Communication Between Two Parties","data_source":"CDR","rule_desc":"Detects unusually frequent calls or messages between two numbers within a short time window.","required_fields":["MOBILENUMBER","B_MOBILENUMBER","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, B_MOBILENUMBER, COUNT(*) AS TOTAL_CALLS FROM cdr WHERE TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER, B_MOBILENUMBER HAVING TOTAL_CALLS > $FREQUENCY_THRESHOLD","custom_params":{"FREQUENCY_THRESHOLD":40}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"8765432109","target_id":"TGT005","target_type":"MOBILE_NUMBER","rule_id":"R002","rule_type":"Rule","rule":"Unusual Call Duration","data_source":"CDR","rule_desc":"Detects abnormally long or short calls.","required_fields":["MOBILENUMBER","B_MOBILENUMBER","DURATION"],"sql_template":"SELECT MOBILENUMBER, B_MOBILENUMBER, DURATION FROM cdr WHERE DURATION < $MIN_DURATION_SEC OR DURATION > $MAX_DURATION_SEC","custom_params":{"MAX_DURATION_SEC":1500}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"8765432109","target_id":"TGT005","target_type":"MOBILE_NUMBER","rule_id":"R003","rule_type":"Rule","rule":"Communication With Known Blacklisted Numbers","data_source":"CDR","rule_desc":"Flags calls or messages to/from numbers on a watchlist.","required_fields":["MOBILENUMBER","B_MOBILENUMBER"],"sql_template":"SELECT c.MOBILENUMBER, c.B_MOBILENUMBER, w.WATCHLIST_ID AS MATCHED_WATCHLIST_ID FROM cdr c JOIN $WATCHLIST_TABLE w ON c.MOBILENUMBER = w.NUMBER OR c.B_MOBILENUMBER = w.NUMBER","custom_params":{}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"8765432109","target_id":"TGT005","target_type":"MOBILE_NUMBER","rule_id":"R004","rule_type":"Rule","rule":"Frequent Cell Tower Location Changes","data_source":"CDR","rule_desc":"Detects rapid movement across large distances.","required_fields":["MOBILENUMBER","BTS","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, COUNT(DISTINCT BTS) AS TOTAL_BTS_CHANGES FROM cdr WHERE TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER HAVING TOTAL_BTS_CHANGES > $LOCATION_CHANGE_THRESHOLD","custom_params":{"LOCATION_CHANGE_THRESHOLD":4}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"8765432109","target_id":"TGT005","target_type":"MOBILE_NUMBER","rule_id":"R005","rule_type":"Rule","rule":"SIM Swap Detection","data_source":"CDR","rule_desc":"Detects multiple IMEIs for same mobile number in a short time window, indicating a potential SIM swap.","required_fields":["MOBILENUMBER","IMEI","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, COUNT(DISTINCT IMEI) AS CHANGE_COUNT FROM cdr WHERE TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER HAVING CHANGE_COUNT > $IMEI_CHANGE_THRESHOLD","custom_params":{}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"8765432109","target_id":"TGT005","target_type":"MOBILE_NUMBER","rule_id":"R006","rule_type":"Rule","rule":"High Volume of International Calls","data_source":"CDR","rule_desc":"Flags unusual spikes in calls to foreign destinations, often used for organized crime.","required_fields":["MOBILENUMBER","DSTCOUNTRY","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, DSTCOUNTRY, COUNT(*) AS TOTAL_FOREIGN_CALLS FROM cdr WHERE DSTCOUNTRY <> 'LOCAL' AND TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER, DSTCOUNTRY HAVING TOTAL_FOREIGN_CALLS > $FOREIGN_CALL_THRESHOLD","custom_params":{"FOREIGN_CALL_THRESHOLD":8}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"8765432109","target_id":"TGT005","target_type":"MOBILE_NUMBER","rule_id":"R009","rule_type":"Rule","rule":"Suspicious VoIP Traffic","data_source":"IPDR","rule_desc":"Detects encrypted or obfuscated VoIP calls outside of normal business hours, which may indicate covert communication.","required_fields":["MOBILENUMBER","APPLICATION","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, APPLICATION FROM ipdr WHERE APPLICATION = 'VoIP' AND (HOUR(TRANSACTIONSTARTTIME) < $ALLOWED_HOURS_START OR HOUR(TRANSACTIONSTARTTIME) > $ALLOWED_HOURS_END)","custom_params":{"ALLOWED_HOURS_END":20,"ALLOWED_HOURS_START":6}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"8765432109","target_id":"TGT005","target_type":"MOBILE_NUMBER","rule_id":"R010","rule_type":"Rule","rule":"Repeated Contact With Foreign IP Addresses","data_source":"IPDR","rule_desc":"Flags repeated communications with the same foreign server IP, which could signal a command-and-control connection.","required_fields":["MOBILENUMBER","SERVERIP","DSTCOUNTRY"],"sql_template":"SELECT MOBILENUMBER, SERVERIP, DSTCOUNTRY FROM ipdr WHERE DSTCOUNTRY <> 'LOCAL' AND TRANSACTIONSTARTTIME >= DATEADD(DAY, -$TIME_WINDOW_DAYS, CURRENT_DATE) GROUP BY MOBILENUMBER, SERVERIP, DSTCOUNTRY HAVING COUNT(*) > $REPEAT_CONTACT_THRESHOLD","custom_params":{}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9090909090","target_id":"TGT009","target_type":"MOBILE_NUMBER","rule_id":"R001","rule_type":"Rule","rule":"High-Frequency Communication Between Two Parties","data_source":"CDR","rule_desc":"Detects unusually frequent calls or messages between two numbers within a short time window.","required_fields":["MOBILENUMBER","B_MOBILENUMBER","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, B_MOBILENUMBER, COUNT(*) AS TOTAL_CALLS FROM cdr WHERE TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER, B_MOBILENUMBER HAVING TOTAL_CALLS > $FREQUENCY_THRESHOLD","custom_params":{"FREQUENCY_THRESHOLD":40}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9090909090","target_id":"TGT009","target_type":"MOBILE_NUMBER","rule_id":"R002","rule_type":"Rule","rule":"Unusual Call Duration","data_source":"CDR","rule_desc":"Detects abnormally long or short calls.","required_fields":["MOBILENUMBER","B_MOBILENUMBER","DURATION"],"sql_template":"SELECT MOBILENUMBER, B_MOBILENUMBER, DURATION FROM cdr WHERE DURATION < $MIN_DURATION_SEC OR DURATION > $MAX_DURATION_SEC","custom_params":{"MAX_DURATION_SEC":1500}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9090909090","target_id":"TGT009","target_type":"MOBILE_NUMBER","rule_id":"R003","rule_type":"Rule","rule":"Communication With Known Blacklisted Numbers","data_source":"CDR","rule_desc":"Flags calls or messages to/from numbers on a watchlist.","required_fields":["MOBILENUMBER","B_MOBILENUMBER"],"sql_template":"SELECT c.MOBILENUMBER, c.B_MOBILENUMBER, w.WATCHLIST_ID AS MATCHED_WATCHLIST_ID FROM cdr c JOIN $WATCHLIST_TABLE w ON c.MOBILENUMBER = w.NUMBER OR c.B_MOBILENUMBER = w.NUMBER","custom_params":{}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9090909090","target_id":"TGT009","target_type":"MOBILE_NUMBER","rule_id":"R004","rule_type":"Rule","rule":"Frequent Cell Tower Location Changes","data_source":"CDR","rule_desc":"Detects rapid movement across large distances.","required_fields":["MOBILENUMBER","BTS","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, COUNT(DISTINCT BTS) AS TOTAL_BTS_CHANGES FROM cdr WHERE TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER HAVING TOTAL_BTS_CHANGES > $LOCATION_CHANGE_THRESHOLD","custom_params":{"LOCATION_CHANGE_THRESHOLD":4}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9090909090","target_id":"TGT009","target_type":"MOBILE_NUMBER","rule_id":"R005","rule_type":"Rule","rule":"SIM Swap Detection","data_source":"CDR","rule_desc":"Detects multiple IMEIs for same mobile number in a short time window, indicating a potential SIM swap.","required_fields":["MOBILENUMBER","IMEI","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, COUNT(DISTINCT IMEI) AS CHANGE_COUNT FROM cdr WHERE TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER HAVING CHANGE_COUNT > $IMEI_CHANGE_THRESHOLD","custom_params":{}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9090909090","target_id":"TGT009","target_type":"MOBILE_NUMBER","rule_id":"R006","rule_type":"Rule","rule":"High Volume of International Calls","data_source":"CDR","rule_desc":"Flags unusual spikes in calls to foreign destinations, often used for organized crime.","required_fields":["MOBILENUMBER","DSTCOUNTRY","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, DSTCOUNTRY, COUNT(*) AS TOTAL_FOREIGN_CALLS FROM cdr WHERE DSTCOUNTRY <> 'LOCAL' AND TRANSACTIONSTARTTIME >= TIMESTAMPADD(HOUR, -$TIME_WINDOW_HOURS, CURRENT_TIMESTAMP) GROUP BY MOBILENUMBER, DSTCOUNTRY HAVING TOTAL_FOREIGN_CALLS > $FOREIGN_CALL_THRESHOLD","custom_params":{"FOREIGN_CALL_THRESHOLD":8}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9090909090","target_id":"TGT009","target_type":"MOBILE_NUMBER","rule_id":"R009","rule_type":"Rule","rule":"Suspicious VoIP Traffic","data_source":"IPDR","rule_desc":"Detects encrypted or obfuscated VoIP calls outside of normal business hours, which may indicate covert communication.","required_fields":["MOBILENUMBER","APPLICATION","TRANSACTIONSTARTTIME"],"sql_template":"SELECT MOBILENUMBER, APPLICATION FROM ipdr WHERE APPLICATION = 'VoIP' AND (HOUR(TRANSACTIONSTARTTIME) < $ALLOWED_HOURS_START OR HOUR(TRANSACTIONSTARTTIME) > $ALLOWED_HOURS_END)","custom_params":{"ALLOWED_HOURS_END":20,"ALLOWED_HOURS_START":6}},
{"group_id":"GRP001","group_name":"Urban Surveillance Group","target":"9090909090","target_id":"TGT009","target_type":"MOBILE_NUMBER","rule_id":"R010","rule_type":"Rule","rule":"Repeated Contact With Foreign IP Addresses","data_source":"IPDR","rule_desc":"Flags repeated communications with the same foreign server IP, which could signal a command-and-control connection.","required_fields":["MOBILENUMBER","SERVERIP","DSTCOUNTRY"],"sql_template":"SELECT MOBILENUMBER, SERVERIP, DSTCOUNTRY FROM ipdr WHERE DSTCOUNTRY <> 'LOCAL' AND TRANSACTIONSTARTTIME >= DATEADD(DAY, -$TIME_WINDOW_DAYS, CURRENT_DATE) GROUP BY MOBILENUMBER, SERVERIP, DSTCOUNTRY HAVING COUNT(*) > $REPEAT_CONTACT_THRESHOLD","custom_params":{}}
]
